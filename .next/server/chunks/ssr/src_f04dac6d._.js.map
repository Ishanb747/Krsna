{"version":3,"sources":["../../../../src/hooks/useHabits.ts","../../../../src/hooks/useTodos.ts","../../../../src/app/%28dashboard%29/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport {\r\n    collection,\r\n    addDoc,\r\n    query,\r\n    where,\r\n    onSnapshot,\r\n    updateDoc,\r\n    doc,\r\n    deleteDoc,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { Habit } from \"@/types/habit\";\r\n\r\nexport function useHabits() {\r\n    const [habits, setHabits] = useState<Habit[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const { user } = useAuth();\r\n\r\n    useEffect(() => {\r\n        if (!user) {\r\n            setHabits([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        const q = query(collection(db, \"habits\"), where(\"userId\", \"==\", user.uid));\r\n\r\n        const unsubscribe = onSnapshot(q, (snapshot) => {\r\n            const newHabits = snapshot.docs.map((doc) => ({\r\n                id: doc.id,\r\n                ...doc.data(),\r\n            })) as Habit[];\r\n            setHabits(newHabits);\r\n            setLoading(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [user]);\r\n\r\n    const addHabit = async (name: string, frequency: Habit[\"frequency\"] = \"daily\") => {\r\n        if (!user) return;\r\n        await addDoc(collection(db, \"habits\"), {\r\n            name,\r\n            frequency,\r\n            streak: 0,\r\n            completedDates: [],\r\n            createdAt: Date.now(),\r\n            userId: user.uid,\r\n        });\r\n    };\r\n\r\n    const toggleHabit = async (id: string) => {\r\n        const habit = habits.find((h) => h.id === id);\r\n        if (!habit) return;\r\n\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n        const todayTimestamp = today.getTime();\r\n\r\n        const isCompletedToday = habit.completedDates.includes(todayTimestamp);\r\n        let newCompletedDates = [...habit.completedDates];\r\n        let newStreak = habit.streak;\r\n\r\n        if (isCompletedToday) {\r\n            newCompletedDates = newCompletedDates.filter((d) => d !== todayTimestamp);\r\n            newStreak = Math.max(0, newStreak - 1);\r\n        } else {\r\n            newCompletedDates.push(todayTimestamp);\r\n            newStreak += 1;\r\n        }\r\n\r\n        await updateDoc(doc(db, \"habits\", id), {\r\n            completedDates: newCompletedDates,\r\n            streak: newStreak,\r\n        });\r\n    };\r\n\r\n    const deleteHabit = async (id: string) => {\r\n        await deleteDoc(doc(db, \"habits\", id));\r\n    };\r\n\r\n    return { habits, loading, addHabit, toggleHabit, deleteHabit };\r\n}\r\n","\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport {\r\n    collection,\r\n    addDoc,\r\n    query,\r\n    where,\r\n    onSnapshot,\r\n    updateDoc,\r\n    deleteDoc,\r\n    doc,\r\n    orderBy,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { Todo } from \"@/types/todo\";\r\n\r\nexport function useTodos() {\r\n    const [todos, setTodos] = useState<Todo[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const { user } = useAuth();\r\n\r\n    useEffect(() => {\r\n        if (!user) {\r\n            setTodos([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        const q = query(\r\n            collection(db, \"todos\"),\r\n            where(\"userId\", \"==\", user.uid),\r\n            orderBy(\"createdAt\", \"desc\")\r\n        );\r\n\r\n        const unsubscribe = onSnapshot(q, (snapshot) => {\r\n            const newTodos = snapshot.docs.map((doc) => ({\r\n                id: doc.id,\r\n                ...doc.data(),\r\n            })) as Todo[];\r\n            setTodos(newTodos);\r\n            setLoading(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [user]);\r\n\r\n    const addTodo = async (text: string, priority: Todo[\"priority\"] = \"medium\") => {\r\n        if (!user) return;\r\n        await addDoc(collection(db, \"todos\"), {\r\n            text,\r\n            completed: false,\r\n            createdAt: Date.now(),\r\n            userId: user.uid,\r\n            priority,\r\n        });\r\n    };\r\n\r\n    const toggleTodo = async (id: string, completed: boolean) => {\r\n        await updateDoc(doc(db, \"todos\", id), { completed });\r\n    };\r\n\r\n    const deleteTodo = async (id: string) => {\r\n        await deleteDoc(doc(db, \"todos\", id));\r\n    };\r\n\r\n    return { todos, loading, addTodo, toggleTodo, deleteTodo };\r\n}\r\n","\"use client\";\r\n\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useHabits } from \"@/hooks/useHabits\";\r\nimport { useTodos } from \"@/hooks/useTodos\";\r\nimport { useEffect } from \"react\";\r\nimport { CheckSquare, Clock, Flame } from \"lucide-react\";\r\n\r\nexport default function DashboardPage() {\r\n  const { user } = useAuth();\r\n  const { habits } = useHabits();\r\n  const { todos, addTodo } = useTodos();\r\n\r\n  // Auto-sync Habits to Todos\r\n  useEffect(() => {\r\n    if (!habits.length || !user) return;\r\n\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    const todayTimestamp = today.getTime();\r\n\r\n    habits.forEach((habit) => {\r\n      // Check if this habit is already in today's todos\r\n      // We assume a convention: Habit todos start with \"Habit: \" or we just match the text\r\n      const habitTodoExists = todos.some(\r\n        (todo) =>\r\n          todo.text === `Habit: ${habit.name}` &&\r\n          todo.createdAt >= todayTimestamp\r\n      );\r\n\r\n      if (!habitTodoExists) {\r\n        addTodo(`Habit: ${habit.name}`, \"medium\");\r\n      }\r\n    });\r\n  }, [habits, user, todos, addTodo]);\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"mb-6 text-4xl font-bold\" style={{ color: \"var(--color-text)\" }}>\r\n        Welcome back, <span style={{ color: \"var(--color-primary)\" }}>{user?.email?.split(\"@\")[0] || \"User\"}</span>!\r\n      </h1>\r\n      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n        <div className=\"cozy-card p-6\">\r\n          <div className=\"mb-4 flex items-center justify-between\">\r\n            <h3 className=\"text-xl font-bold\">Today's Tasks</h3>\r\n            <CheckSquare className=\"h-6 w-6 text-[var(--color-primary)]\" />\r\n          </div>\r\n          <p className=\"text-3xl font-bold\">{todos.filter(t => !t.completed).length} remaining</p>\r\n        </div>\r\n        \r\n        <div className=\"cozy-card p-6\">\r\n          <div className=\"mb-4 flex items-center justify-between\">\r\n            <h3 className=\"text-xl font-bold\">Focus Time</h3>\r\n            <Clock className=\"h-6 w-6 text-[var(--color-accent)]\" />\r\n          </div>\r\n          <p className=\"text-3xl font-bold\">0m focused</p>\r\n        </div>\r\n\r\n        <div className=\"cozy-card p-6\">\r\n          <div className=\"mb-4 flex items-center justify-between\">\r\n            <h3 className=\"text-xl font-bold\">Habit Streak</h3>\r\n            <Flame className=\"h-6 w-6 text-[var(--color-danger)]\" />\r\n          </div>\r\n          <p className=\"text-3xl font-bold\">\r\n            {Math.max(...habits.map((h) => h.streak), 0)} day best\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}